<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ggHoriPlot • ggHoriPlot</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="ggHoriPlot">
<meta property="og:description" content="ggHoriPlot">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ggHoriPlot</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/ggHoriPlot.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/examples.html">Examples with real data</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/rivasiker/ggHoriPlot/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="ggHoriPlot_files/header-attrs-2.10/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>ggHoriPlot</h1>
                        <h4 class="author">Iker Rivas-González</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/rivasiker/ggHoriPlot/blob/master/vignettes/ggHoriPlot.Rmd"><code>vignettes/ggHoriPlot.Rmd</code></a></small>
      <div class="hidden name"><code>ggHoriPlot.Rmd</code></div>

    </div>

    
    
<p>This vignette goes through all the functionality of the package. If you want to see examples with real data, you can refer to <code><a href="../articles/examples.html">vignette('examples', 'ggHoriPlot')</a></code>.</p>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>The data used through this vignette are tables with sine waves, which aims to mimic time-series data. The data looks like this:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com">patchwork</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jrnold/ggthemes">ggthemes</a></span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">300</span>
<span class="va">y</span> <span class="op">=</span> <span class="va">x</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">0.1</span> <span class="op">*</span> <span class="va">x</span><span class="op">)</span>
<span class="va">dat_tab</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>,
       xend <span class="op">=</span> <span class="va">x</span><span class="op">+</span><span class="fl">0.9999</span>,
       y <span class="op">=</span> <span class="va">y</span><span class="op">)</span>

<span class="va">x</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">400</span>
<span class="va">y</span> <span class="op">=</span> <span class="va">x</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">0.2</span> <span class="op">*</span> <span class="va">x</span><span class="op">)</span> <span class="op">+</span> <span class="fl">100</span>
<span class="va">dat_tab_bis</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>,
       xend <span class="op">=</span> <span class="va">x</span><span class="op">+</span><span class="fl">0.9999</span>,
       y <span class="op">=</span> <span class="va">y</span><span class="op">)</span>

<span class="va">tab_tot</span> <span class="op">&lt;-</span> <span class="fu">mutate</span><span class="op">(</span><span class="va">dat_tab</span>, type <span class="op">=</span> <span class="st">'A'</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">bind_rows</span><span class="op">(</span><span class="fu">mutate</span><span class="op">(</span><span class="va">dat_tab_bis</span>, type<span class="op">=</span><span class="st">'B'</span><span class="op">)</span><span class="op">)</span>

<span class="va">tab_tot</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">type</span>, scales <span class="op">=</span> <span class="st">'free_y'</span>, ncol <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_few.html">theme_few</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="ggHoriPlot_files/figure-html/data-1.png" width="700"></p>
<p>This representation of the dataset is fine if we only have a few waves. However, if we aim to represent and compare time series with many entries, it might be challenging to plot them as line charts. A more convenient way to plot this type of datasets are horizon plots, which are able to condense the data but still retain all the information. You can learn more about horizon plots <a href="https://bernatgel.github.io/karyoploter_tutorial/Tutorial/PlotHorizon/PlotHorizon.html">here</a>.</p>
<p><code>ggHoriPlot</code> allows you to easily build horizon plots in <code>ggplot2</code>. First we will load the package and a helper functions that can be used to visualize and compare horizon plots and line charts.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://rivasiker.github.io/ggHoriPlot/">ggHoriPlot</a></span><span class="op">)</span>


<span class="va">plotAllLayers</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">dat</span>, <span class="va">ori</span>, <span class="va">cutpoints</span>, <span class="va">colors</span><span class="op">)</span><span class="op">{</span>
  <span class="co"># Helper function to plot the origin and cutpoints </span>
  <span class="co"># of the horizon plot for comparison</span>
  <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span>
  <span class="va">acc</span> <span class="op">&lt;-</span> <span class="fl">1</span>
  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">cutpoints</span><span class="op">[</span><span class="va">cutpoints</span><span class="op">&lt;=</span><span class="va">ori</span><span class="op">]</span><span class="op">)</span> <span class="op">{</span> 
    <span class="va">colo</span> <span class="op">&lt;-</span> <span class="va">colors</span><span class="op">[</span><span class="va">acc</span><span class="op">]</span>
    <span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span> <span class="fu">geom_ribbon</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, ymin <span class="op">=</span> <span class="va">y</span>, ymax <span class="op">=</span> <span class="va">ori</span><span class="op">)</span>,
                         fill <span class="op">=</span> <span class="va">colo</span>,
              data <span class="op">=</span> <span class="fu">mutate</span><span class="op">(</span><span class="va">dat</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu">between</span><span class="op">(</span><span class="va">y</span>, <span class="va">i</span>, <span class="va">ori</span><span class="op">)</span>, <span class="va">y</span>, 
                                                <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">y</span><span class="op">&lt;</span><span class="va">ori</span>, <span class="va">i</span>, <span class="va">ori</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
    <span class="va">acc</span> <span class="op">&lt;-</span> <span class="va">acc</span><span class="op">+</span><span class="fl">1</span>
  <span class="op">}</span>
  <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="va">cutpoints</span><span class="op">[</span><span class="va">cutpoints</span><span class="op">&gt;=</span><span class="va">ori</span><span class="op">]</span><span class="op">)</span> <span class="op">{</span> 
    <span class="va">colo</span> <span class="op">&lt;-</span> <span class="va">colors</span><span class="op">[</span><span class="va">acc</span><span class="op">]</span>
    <span class="va">p</span> <span class="op">&lt;-</span> <span class="va">p</span> <span class="op">+</span> <span class="fu">geom_ribbon</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">y</span>, ymin <span class="op">=</span> <span class="va">ori</span>, ymax <span class="op">=</span> <span class="va">y</span><span class="op">)</span>,
                         fill <span class="op">=</span> <span class="va">colo</span>,
              data <span class="op">=</span> <span class="fu">mutate</span><span class="op">(</span><span class="va">dat</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu">between</span><span class="op">(</span><span class="va">y</span>, <span class="va">ori</span>, <span class="va">i</span><span class="op">)</span>, <span class="va">y</span>, 
                                                <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">y</span><span class="op">&gt;</span><span class="va">ori</span>, <span class="va">i</span>, <span class="va">ori</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
    <span class="va">acc</span> <span class="op">&lt;-</span> <span class="va">acc</span><span class="op">+</span><span class="fl">1</span>
  <span class="op">}</span>
  
  
  <span class="va">p</span><span class="op">+</span><span class="fu">geom_line</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span>, data<span class="op">=</span><span class="va">dat</span><span class="op">)</span><span class="op">+</span>
    <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_few.html">theme_few</a></span><span class="op">(</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>We are now all set! By using <code><a href="../reference/geom_horizon.html">geom_horizon()</a></code> we can add a layer in the <code>ggplot2</code> framework to build a horizon plot.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">a</span> <span class="op">&lt;-</span> <span class="va">dat_tab</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/geom_horizon.html">geom_horizon</a></span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y<span class="op">=</span><span class="va">y</span><span class="op">)</span><span class="op">)</span> 

<span class="va">a</span></code></pre></div>
<p><img src="ggHoriPlot_files/figure-html/midpoint_1-1.png" width="672"></p>
<p>The default <code>ggplot2</code> fill colors might not be the best choice of palette for horizon plots. Instead, we can use the <code><a href="../reference/scale_fill_hcl.html">scale_fill_hcl()</a></code> function to choose an appropriate color scheme. The default palette will color low values red and large values blue.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">a</span> <span class="op">&lt;-</span> <span class="va">dat_tab</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/geom_horizon.html">geom_horizon</a></span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y<span class="op">=</span><span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_few.html">theme_few</a></span><span class="op">(</span><span class="op">)</span>  <span class="op">+</span>
  <span class="fu"><a href="../reference/scale_fill_hcl.html">scale_fill_hcl</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">a</span></code></pre></div>
<p><img src="ggHoriPlot_files/figure-html/midpoint_2-1.png" width="672"></p>
<p>To understand how horizon plots are related to line charts, we can plot both side by side.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">a</span> <span class="op">&lt;-</span> <span class="va">dat_tab</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/geom_horizon.html">geom_horizon</a></span><span class="op">(</span>
    <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, 
    y<span class="op">=</span><span class="va">y</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_few.html">theme_few</a></span><span class="op">(</span><span class="op">)</span>  <span class="op">+</span>
  <span class="fu"><a href="../reference/scale_fill_hcl.html">scale_fill_hcl</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">cutpoints</span>  <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>
  cuts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">78.48221</span>,  <span class="fl">172.74027</span>,  <span class="fl">266.99833</span>, <span class="op">-</span><span class="fl">110.03390</span>, <span class="op">-</span><span class="fl">204.29196</span>, <span class="op">-</span><span class="fl">298.55001</span><span class="op">)</span>,
  names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'ypos1'</span>, <span class="st">'ypos2'</span>, <span class="st">'ypos3'</span>, <span class="st">'yneg1'</span>, <span class="st">'yneg2'</span>, <span class="st">'yneg3'</span><span class="op">)</span>, 
  color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#D7E2D4"</span>, <span class="st">"#36ABA9"</span>, <span class="st">"#324DA0"</span>, <span class="st">"#F6DE90"</span>, <span class="st">"#E78200"</span>, <span class="st">"#A51122"</span><span class="op">)</span>
<span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">names</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="va">names</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">arrange</span><span class="op">(</span><span class="va">names</span><span class="op">)</span>


<span class="va">mid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">dat_tab</span><span class="op">$</span><span class="va">y</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>

<span class="va">b</span> <span class="op">&lt;-</span> <span class="fu">plotAllLayers</span><span class="op">(</span><span class="va">dat_tab</span>, <span class="va">mid</span>, <span class="va">cutpoints</span><span class="op">$</span><span class="va">cuts</span>, <span class="va">cutpoints</span><span class="op">$</span><span class="va">color</span><span class="op">)</span>

<span class="va">b</span><span class="op">/</span><span class="va">a</span><span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span><span class="op">(</span>guides <span class="op">=</span> <span class="st">'collect'</span>, heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="ggHoriPlot_files/figure-html/midpoint_3-1.png" width="700"></p>
<p>The resulting figure shows how the sine curve of this example can be condensed into a stripe instead of a full line chart.</p>
<p><code>ggHoriPlot</code> can also output the exact intervals for each cutpoint by simply adding <code>fill=..Cutpoints..</code> in the aesthetics:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">a</span> <span class="op">&lt;-</span> <span class="va">dat_tab</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/geom_horizon.html">geom_horizon</a></span><span class="op">(</span>
    <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, 
    y<span class="op">=</span><span class="va">y</span>, 
    fill<span class="op">=</span><span class="va">..Cutpoints..</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_few.html">theme_few</a></span><span class="op">(</span><span class="op">)</span>  <span class="op">+</span>
  <span class="fu"><a href="../reference/scale_fill_hcl.html">scale_fill_hcl</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">cutpoints</span>  <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>
  cuts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">78.48221</span>,  <span class="fl">172.74027</span>,  <span class="fl">266.99833</span>, <span class="op">-</span><span class="fl">110.03390</span>, <span class="op">-</span><span class="fl">204.29196</span>, <span class="op">-</span><span class="fl">298.55001</span><span class="op">)</span>,
  names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'ypos1'</span>, <span class="st">'ypos2'</span>, <span class="st">'ypos3'</span>, <span class="st">'yneg1'</span>, <span class="st">'yneg2'</span>, <span class="st">'yneg3'</span><span class="op">)</span>, 
  color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#D7E2D4"</span>, <span class="st">"#36ABA9"</span>, <span class="st">"#324DA0"</span>, <span class="st">"#F6DE90"</span>, <span class="st">"#E78200"</span>, <span class="st">"#A51122"</span><span class="op">)</span>
<span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">names</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="va">names</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">arrange</span><span class="op">(</span><span class="va">names</span><span class="op">)</span>


<span class="va">mid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">dat_tab</span><span class="op">$</span><span class="va">y</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>

<span class="va">b</span> <span class="op">&lt;-</span> <span class="fu">plotAllLayers</span><span class="op">(</span><span class="va">dat_tab</span>, <span class="va">mid</span>, <span class="va">cutpoints</span><span class="op">$</span><span class="va">cuts</span>, <span class="va">cutpoints</span><span class="op">$</span><span class="va">color</span><span class="op">)</span>

<span class="va">b</span><span class="op">/</span><span class="va">a</span><span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span><span class="op">(</span>guides <span class="op">=</span> <span class="st">'collect'</span>, heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="ggHoriPlot_files/figure-html/midpoint_4_bis-1.png" width="700"></p>
</div>
<div id="changing-the-origin" class="section level1">
<h1 class="hasAnchor">
<a href="#changing-the-origin" class="anchor"></a>Changing the origin</h1>
<div id="median" class="section level2">
<h2 class="hasAnchor">
<a href="#median" class="anchor"></a>Median</h2>
<p>The above example with default settings calculates the origin of the horizon plot as the midpoint between the data range. Sometimes, however, we might want to use some other origin for our data. In <code>ggHoriPlot</code> this can be achieved by specifying the desired <code>origin</code> argument in <code><a href="../reference/geom_horizon.html">geom_horizon()</a></code>. For example, if we want to use the median as the origin:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">a</span> <span class="op">&lt;-</span> <span class="va">dat_tab</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/geom_horizon.html">geom_horizon</a></span><span class="op">(</span>
    <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, 
    y<span class="op">=</span><span class="va">y</span>,
    fill<span class="op">=</span><span class="va">..Cutpoints..</span><span class="op">)</span>, 
    origin <span class="op">=</span> <span class="st">'median'</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_few.html">theme_few</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/scale_fill_hcl.html">scale_fill_hcl</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">cutpoints</span>  <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>
  cuts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">96.20134</span>, <span class="fl">190.4594</span>, <span class="fl">284.7174</span>, <span class="op">-</span><span class="fl">92.31478</span>, <span class="op">-</span><span class="fl">186.57283</span>, <span class="op">-</span><span class="fl">280.83089</span><span class="op">)</span>,
  names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'ypos1'</span>, <span class="st">'ypos2'</span>, <span class="st">'ypos3'</span>, <span class="st">'yneg1'</span>, <span class="st">'yneg2'</span>, <span class="st">'yneg3'</span><span class="op">)</span>, 
  color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#D7E2D4"</span>, <span class="st">"#36ABA9"</span>, <span class="st">"#324DA0"</span>, <span class="st">"#F6DE90"</span>, <span class="st">"#E78200"</span>, <span class="st">"#A51122"</span><span class="op">)</span>
<span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">names</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="va">names</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">arrange</span><span class="op">(</span><span class="va">names</span><span class="op">)</span>

<span class="va">me</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">dat_tab</span><span class="op">$</span><span class="va">y</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>

<span class="va">b</span> <span class="op">&lt;-</span> <span class="fu">plotAllLayers</span><span class="op">(</span><span class="va">dat_tab</span>, <span class="va">me</span>, <span class="va">cutpoints</span><span class="op">$</span><span class="va">cuts</span>, <span class="va">cutpoints</span><span class="op">$</span><span class="va">color</span><span class="op">)</span>

<span class="va">b</span><span class="op">/</span><span class="va">a</span><span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span><span class="op">(</span>guides <span class="op">=</span> <span class="st">'collect'</span>, heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="ggHoriPlot_files/figure-html/median-1.png" width="700"></p>
<p>Note that the horizon scale –this is, the regular interval that determines the cutpoints–, is still the same as when using the midpoint. This might produce some cutpoints that do not entirely match the range of values. In the above example, limit for the upper interval (the bluest interval) falls outside of the range of values. At the other end, the limit for the lower interval (the reddest interval) falls within the range of the data. All the data values that are above the upper limit or (as happens in this case) below the lower limit are colored as the closest interval.</p>
</div>
<div id="mean" class="section level2">
<h2 class="hasAnchor">
<a href="#mean" class="anchor"></a>Mean</h2>
<p>The origin can also be specified to be the mean:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">a</span> <span class="op">&lt;-</span> <span class="va">dat_tab</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/geom_horizon.html">geom_horizon</a></span><span class="op">(</span>
    <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, 
    y<span class="op">=</span><span class="va">y</span>,
    fill<span class="op">=</span><span class="va">..Cutpoints..</span><span class="op">)</span>, 
    origin <span class="op">=</span> <span class="st">'mean'</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_few.html">theme_few</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/scale_fill_hcl.html">scale_fill_hcl</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">cutpoints</span>  <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>
  cuts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">91.89319</span>,  <span class="fl">186.15125</span>,  <span class="fl">280.40931</span>,  <span class="op">-</span><span class="fl">96.62292</span>, <span class="op">-</span><span class="fl">190.88098</span>, <span class="op">-</span><span class="fl">285.13903</span><span class="op">)</span>,
  names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'ypos1'</span>, <span class="st">'ypos2'</span>, <span class="st">'ypos3'</span>, <span class="st">'yneg1'</span>, <span class="st">'yneg2'</span>, <span class="st">'yneg3'</span><span class="op">)</span>, 
  color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#D7E2D4"</span>, <span class="st">"#36ABA9"</span>, <span class="st">"#324DA0"</span>, <span class="st">"#F6DE90"</span>, <span class="st">"#E78200"</span>, <span class="st">"#A51122"</span><span class="op">)</span>
<span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>
    names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">names</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="va">names</span><span class="op">)</span><span class="op">)</span>,
    y_max <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="va">cuts</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">cuts</span><span class="op">)</span>,
              <span class="op">-</span><span class="cn">Inf</span>, 
              <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span>
                <span class="va">cuts</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">cuts</span><span class="op">)</span>, 
                <span class="cn">Inf</span>,
                <span class="va">cuts</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">arrange</span><span class="op">(</span><span class="va">names</span><span class="op">)</span>


<span class="va">me</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">dat_tab</span><span class="op">$</span><span class="va">y</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>

<span class="va">b</span> <span class="op">&lt;-</span> <span class="fu">plotAllLayers</span><span class="op">(</span><span class="va">dat_tab</span>, <span class="va">me</span>, <span class="va">cutpoints</span><span class="op">$</span><span class="va">cuts</span>, <span class="va">cutpoints</span><span class="op">$</span><span class="va">color</span><span class="op">)</span>


<span class="va">b</span><span class="op">/</span><span class="va">a</span><span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span><span class="op">(</span>guides <span class="op">=</span> <span class="st">'collect'</span>, heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="ggHoriPlot_files/figure-html/mean-1.png" width="700"></p>
</div>
<div id="user-specified" class="section level2">
<h2 class="hasAnchor">
<a href="#user-specified" class="anchor"></a>User-specified</h2>
<p>Alternatively, the origin might also be a manually chosen number:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">a</span> <span class="op">&lt;-</span> <span class="va">dat_tab</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/geom_horizon.html">geom_horizon</a></span><span class="op">(</span>
    <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, 
    y<span class="op">=</span><span class="va">y</span>,
    fill<span class="op">=</span><span class="va">..Cutpoints..</span><span class="op">)</span>, 
    origin <span class="op">=</span> <span class="fl">50</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_few.html">theme_few</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/scale_fill_hcl.html">scale_fill_hcl</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">cutpoints</span>  <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>
  cuts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">144.25806</span>,  <span class="fl">238.51611</span>,  <span class="fl">332.77417</span>,  <span class="op">-</span><span class="fl">44.25806</span>, <span class="op">-</span><span class="fl">138.51611</span>, <span class="op">-</span><span class="fl">232.77417</span><span class="op">)</span>,
  names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'ypos1'</span>, <span class="st">'ypos2'</span>, <span class="st">'ypos3'</span>, <span class="st">'yneg1'</span>, <span class="st">'yneg2'</span>, <span class="st">'yneg3'</span><span class="op">)</span>, 
  color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#D7E2D4"</span>, <span class="st">"#36ABA9"</span>, <span class="st">"#324DA0"</span>, <span class="st">"#F6DE90"</span>, <span class="st">"#E78200"</span>, <span class="st">"#A51122"</span><span class="op">)</span>
<span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">names</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="va">names</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">arrange</span><span class="op">(</span><span class="va">names</span><span class="op">)</span>



<span class="va">b</span> <span class="op">&lt;-</span> <span class="fu">plotAllLayers</span><span class="op">(</span><span class="va">dat_tab</span>, <span class="fl">50</span>, <span class="va">cutpoints</span><span class="op">$</span><span class="va">cuts</span>, <span class="va">cutpoints</span><span class="op">$</span><span class="va">color</span><span class="op">)</span>

<span class="va">b</span><span class="op">/</span><span class="va">a</span><span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span><span class="op">(</span>guides <span class="op">=</span> <span class="st">'collect'</span>, heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="ggHoriPlot_files/figure-html/integer-1.png" width="700"></p>
</div>
<div id="quantiles" class="section level2">
<h2 class="hasAnchor">
<a href="#quantiles" class="anchor"></a>Quantiles</h2>
<p>If we specify the origin to be <code>quantiles</code>, then the origin will be set to the median and the cutpoints will be set to equally sized quantiles:</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">a</span> <span class="op">&lt;-</span> <span class="va">dat_tab</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/geom_horizon.html">geom_horizon</a></span><span class="op">(</span>
    <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, 
    y<span class="op">=</span><span class="va">y</span>,
    fill<span class="op">=</span><span class="va">..Cutpoints..</span><span class="op">)</span>, 
    origin <span class="op">=</span> <span class="st">'quantiles'</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_few.html">theme_few</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/scale_fill_hcl.html">scale_fill_hcl</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">cutpoints</span>  <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>
  cuts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">43.02642</span>,  <span class="fl">124.15063</span>,  <span class="fl">266.99833</span>,  <span class="op">-</span><span class="fl">45.43396</span>, <span class="op">-</span><span class="fl">119.31147</span>, <span class="op">-</span><span class="fl">298.55001</span> <span class="op">)</span>,
  names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'ypos1'</span>, <span class="st">'ypos2'</span>, <span class="st">'ypos3'</span>, <span class="st">'yneg1'</span>, <span class="st">'yneg2'</span>, <span class="st">'yneg3'</span><span class="op">)</span>, 
  color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#D7E2D4"</span>, <span class="st">"#36ABA9"</span>, <span class="st">"#324DA0"</span>, <span class="st">"#F6DE90"</span>, <span class="st">"#E78200"</span>, <span class="st">"#A51122"</span><span class="op">)</span>
<span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">names</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="va">names</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">arrange</span><span class="op">(</span><span class="va">names</span><span class="op">)</span>

<span class="va">me</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="va">dat_tab</span><span class="op">$</span><span class="va">y</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>

<span class="va">b</span> <span class="op">&lt;-</span> <span class="fu">plotAllLayers</span><span class="op">(</span><span class="va">dat_tab</span>, <span class="va">me</span>, <span class="va">cutpoints</span><span class="op">$</span><span class="va">cuts</span>, <span class="va">cutpoints</span><span class="op">$</span><span class="va">color</span><span class="op">)</span>

<span class="va">b</span><span class="op">/</span><span class="va">a</span><span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span><span class="op">(</span>guides <span class="op">=</span> <span class="st">'collect'</span>, heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="ggHoriPlot_files/figure-html/quantiles-1.png" width="700"></p>
<p>Note that this might produce intervals that do not have the same size, which can be undesirable and/or deceiving.</p>
</div>
<div id="origin-as-lowest-value" class="section level2">
<h2 class="hasAnchor">
<a href="#origin-as-lowest-value" class="anchor"></a>Origin as lowest value</h2>
<p>Sometimes we are not interested in plotting values as both above and below the origin. In those cases, we can specify the origin to be the smallest value by setting <code>origin='min'</code>, so all values are above the origin.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">a</span> <span class="op">&lt;-</span> <span class="va">dat_tab</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/geom_horizon.html">geom_horizon</a></span><span class="op">(</span>
    <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, 
    <span class="co"># xend = xend, </span>
    y<span class="op">=</span><span class="va">y</span>,
    fill<span class="op">=</span><span class="va">..Cutpoints..</span><span class="op">)</span>, 
    horizonscale <span class="op">=</span> <span class="fl">6</span>,
    origin <span class="op">=</span> <span class="st">'min'</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_few.html">theme_few</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/scale_fill_hcl.html">scale_fill_hcl</a></span><span class="op">(</span><span class="op">)</span>



<span class="va">cutpoints_a</span>  <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>
  cuts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">15.78</span>, <span class="fl">78.48</span>,  <span class="fl">172.74</span>,  <span class="fl">266.998</span>, <span class="op">-</span><span class="fl">110.034</span>, <span class="op">-</span><span class="fl">204.292</span>, <span class="op">-</span><span class="fl">298.55</span><span class="op">)</span>,
  color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#D7E2D4"</span>, <span class="st">"#36ABA9"</span>, <span class="st">"#324DA0"</span>, <span class="st">'white'</span>, <span class="st">"#F6DE90"</span>, <span class="st">"#E78200"</span>, <span class="st">"#A51122"</span><span class="op">)</span>
<span class="op">)</span> 

<span class="va">cutpoints_a</span>  <span class="op">&lt;-</span> <span class="va">cutpoints_a</span> <span class="op">%&gt;%</span> <span class="fu">arrange</span><span class="op">(</span><span class="fu">desc</span><span class="op">(</span><span class="va">cuts</span><span class="op">)</span><span class="op">)</span>


<span class="va">b</span> <span class="op">&lt;-</span> <span class="fu">plotAllLayers</span><span class="op">(</span><span class="va">dat_tab</span>, <span class="op">-</span><span class="fl">298.55</span>, <span class="va">cutpoints_a</span><span class="op">$</span><span class="va">cuts</span>, <span class="va">cutpoints_a</span><span class="op">$</span><span class="va">color</span><span class="op">)</span>

<span class="op">(</span><span class="va">b</span><span class="op">/</span><span class="va">a</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span><span class="op">(</span>guides <span class="op">=</span> <span class="st">'collect'</span>, heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="ggHoriPlot_files/figure-html/min-1.png" width="700"></p>
<p>For this example the red and blue coloring does not make much sense. Instead, you can choose another hcl palette and specify it in <code><a href="../reference/scale_fill_hcl.html">scale_fill_hcl()</a></code>. For example, a single-hue palette is much more appropriate:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">a</span> <span class="op">&lt;-</span> <span class="va">dat_tab</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/geom_horizon.html">geom_horizon</a></span><span class="op">(</span>
    <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, 
    <span class="co"># xend = xend, </span>
    y<span class="op">=</span><span class="va">y</span>,
    fill<span class="op">=</span><span class="va">..Cutpoints..</span><span class="op">)</span>, 
    horizonscale <span class="op">=</span> <span class="fl">6</span>,
    origin <span class="op">=</span> <span class="st">'min'</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_few.html">theme_few</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/scale_fill_hcl.html">scale_fill_hcl</a></span><span class="op">(</span>palette <span class="op">=</span> <span class="st">'Purple-Orange'</span>, reverse <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>



<span class="va">cutpoints_a</span>  <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>
  cuts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">15.78</span>, <span class="fl">78.48</span>,  <span class="fl">172.74</span>,  <span class="fl">266.998</span>, <span class="op">-</span><span class="fl">110.034</span>, <span class="op">-</span><span class="fl">204.292</span>, <span class="op">-</span><span class="fl">298.55</span><span class="op">)</span>,
  color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span> <span class="st">"#B76AA8"</span>, <span class="st">"#8F4D9F"</span>,<span class="st">"#5B3794"</span>, <span class="st">'white'</span>, <span class="st">"#D78CB1"</span>, <span class="st">"#F1B1BE"</span>, <span class="st">"#F8DCD9"</span><span class="op">)</span>
<span class="op">)</span> 

<span class="va">cutpoints_a</span>  <span class="op">&lt;-</span> <span class="va">cutpoints_a</span> <span class="op">%&gt;%</span> <span class="fu">arrange</span><span class="op">(</span><span class="fu">desc</span><span class="op">(</span><span class="va">cuts</span><span class="op">)</span><span class="op">)</span>


<span class="va">b</span> <span class="op">&lt;-</span> <span class="fu">plotAllLayers</span><span class="op">(</span><span class="va">dat_tab</span>, <span class="op">-</span><span class="fl">298.55</span>, <span class="va">cutpoints_a</span><span class="op">$</span><span class="va">cuts</span>, <span class="va">cutpoints_a</span><span class="op">$</span><span class="va">color</span><span class="op">)</span>

<span class="op">(</span><span class="va">b</span><span class="op">/</span><span class="va">a</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span><span class="op">(</span>guides <span class="op">=</span> <span class="st">'collect'</span>, heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="ggHoriPlot_files/figure-html/min_2-1.png" width="700"></p>
<p>You can list all available palettes by running <code><a href="https://rdrr.io/r/grDevices/palettes.html">hcl.pals()</a></code>.</p>
</div>
</div>
<div id="changing-the-horizon-scale" class="section level1">
<h1 class="hasAnchor">
<a href="#changing-the-horizon-scale" class="anchor"></a>Changing the horizon scale</h1>
<p>Apart from the origin, <code>ggHoriPlot</code> also allows to customize the horizon scale, this is, the number of cuts and where they happen. The default number of cuts is set to 6, as in all of the examples above, but it can be set to any other integer, such as 5 intervals:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">a</span> <span class="op">&lt;-</span> <span class="va">dat_tab</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/geom_horizon.html">geom_horizon</a></span><span class="op">(</span>
    <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, 
    <span class="co"># xend = xend, </span>
    y<span class="op">=</span><span class="va">y</span>,
    fill<span class="op">=</span><span class="va">..Cutpoints..</span><span class="op">)</span>, 
    horizonscale <span class="op">=</span> <span class="fl">5</span>,
    origin <span class="op">=</span> <span class="st">'midpoint'</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_few.html">theme_few</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/scale_fill_hcl.html">scale_fill_hcl</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">cutpoints</span>  <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>
  cuts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">97.33383</span>,  <span class="fl">210.44349</span>, <span class="op">-</span><span class="fl">128.88551</span>, <span class="op">-</span><span class="fl">241.99518</span>, <span class="op">-</span><span class="fl">355.10485</span><span class="op">)</span>,
  names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'ypos1'</span>, <span class="st">'ypos2'</span>,  <span class="st">'yneg1'</span>, <span class="st">'yneg2'</span>, <span class="st">'yneg3'</span><span class="op">)</span>, 
  color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#69BBAB"</span>, <span class="st">"#324DA0"</span>, <span class="st">"#FEFDBE"</span>, <span class="st">"#EB9C00"</span>, <span class="st">"#A51122"</span><span class="op">)</span>
<span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">names</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="va">names</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">arrange</span><span class="op">(</span><span class="va">names</span><span class="op">)</span>


<span class="va">mid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">dat_tab</span><span class="op">$</span><span class="va">y</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>

<span class="va">b</span> <span class="op">&lt;-</span> <span class="fu">plotAllLayers</span><span class="op">(</span><span class="va">dat_tab</span>, <span class="va">mid</span>, <span class="va">cutpoints</span><span class="op">$</span><span class="va">cuts</span>, <span class="va">cutpoints</span><span class="op">$</span><span class="va">color</span><span class="op">)</span>

<span class="va">b</span><span class="op">/</span><span class="va">a</span><span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span><span class="op">(</span>guides <span class="op">=</span> <span class="st">'collect'</span>, heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="ggHoriPlot_files/figure-html/midpoint_n5-1.png" width="700"></p>
<p>or 10 intervals instead:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">a</span> <span class="op">&lt;-</span> <span class="va">dat_tab</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/geom_horizon.html">geom_horizon</a></span><span class="op">(</span>
    <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, 
    <span class="co"># xend = xend, </span>
    y<span class="op">=</span><span class="va">y</span>,
    fill<span class="op">=</span><span class="va">..Cutpoints..</span><span class="op">)</span>, 
    horizonscale <span class="op">=</span> <span class="fl">10</span>,
    origin <span class="op">=</span> <span class="st">'midpoint'</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_few.html">theme_few</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/scale_fill_hcl.html">scale_fill_hcl</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">cutpoints</span>  <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>
  cuts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">40.77899</span> ,  <span class="fl">97.33383</span> , <span class="fl">153.88866</span>,  <span class="fl">210.44349</span> , <span class="fl">266.99833</span> ,
           <span class="op">-</span><span class="fl">72.33068</span>, <span class="op">-</span><span class="fl">128.88551</span>, <span class="op">-</span><span class="fl">185.44035</span>, <span class="op">-</span><span class="fl">241.99518</span>, <span class="op">-</span><span class="fl">298.55001</span><span class="op">)</span>,
  names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'ypos1'</span>, <span class="st">'ypos2'</span>, <span class="st">'ypos3'</span>, <span class="st">'ypos4'</span>, <span class="st">'ypos5'</span>, <span class="st">'yneg1'</span>, <span class="st">'yneg2'</span>, <span class="st">'yneg3'</span>, <span class="st">'yneg4'</span>, <span class="st">'yneg5'</span><span class="op">)</span>, 
  color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#E5F0D6"</span>, <span class="st">"#ACD2BB"</span> ,<span class="st">"#4EB2A9"</span> ,<span class="st">"#0088A7"</span>, <span class="st">"#324DA0"</span>,
                <span class="st">"#FAEDA9"</span>,<span class="st">"#F1C363"</span>,<span class="st">"#E98E00"</span>, <span class="st">"#DC4A00"</span>, <span class="st">"#A51122"</span><span class="op">)</span>
<span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">names</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="va">names</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">arrange</span><span class="op">(</span><span class="va">names</span><span class="op">)</span>

<span class="va">mid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">dat_tab</span><span class="op">$</span><span class="va">y</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>

<span class="va">b</span> <span class="op">&lt;-</span> <span class="fu">plotAllLayers</span><span class="op">(</span><span class="va">dat_tab</span>, <span class="va">mid</span>, <span class="va">cutpoints</span><span class="op">$</span><span class="va">cuts</span>, <span class="va">cutpoints</span><span class="op">$</span><span class="va">color</span><span class="op">)</span>


<span class="va">b</span><span class="op">/</span><span class="va">a</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span><span class="op">(</span>guides <span class="op">=</span> <span class="st">'collect'</span>, heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="ggHoriPlot_files/figure-html/midpoint_n10-1.png" width="700"></p>
<p>Finally, we can also specify our own intervals by providing a vector of cutpoints:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">a</span> <span class="op">&lt;-</span> <span class="va">dat_tab</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/geom_horizon.html">geom_horizon</a></span><span class="op">(</span>
    <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, 
    y<span class="op">=</span><span class="va">y</span>, 
    fill<span class="op">=</span><span class="va">..Cutpoints..</span><span class="op">)</span>,
    horizonscale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">78.48221</span>,  <span class="fl">172.74027</span>,  
                     <span class="fl">266.99833</span>, <span class="op">-</span><span class="fl">110.03390</span>, 
                     <span class="op">-</span><span class="fl">204.29196</span>, <span class="op">-</span><span class="fl">298.55001</span><span class="op">)</span>,
    origin <span class="op">=</span> <span class="op">-</span><span class="fl">15.77584</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_few.html">theme_few</a></span><span class="op">(</span><span class="op">)</span>  <span class="op">+</span>
  <span class="fu"><a href="../reference/scale_fill_hcl.html">scale_fill_hcl</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">cutpoints</span>  <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>
  cuts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">78.48221</span>,  <span class="fl">172.74027</span>,  <span class="fl">266.99833</span>, <span class="op">-</span><span class="fl">110.03390</span>, <span class="op">-</span><span class="fl">204.29196</span>, <span class="op">-</span><span class="fl">298.55001</span><span class="op">)</span>,
  names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'ypos1'</span>, <span class="st">'ypos2'</span>, <span class="st">'ypos3'</span>, <span class="st">'yneg1'</span>, <span class="st">'yneg2'</span>, <span class="st">'yneg3'</span><span class="op">)</span>, 
  color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#D7E2D4"</span>, <span class="st">"#36ABA9"</span>, <span class="st">"#324DA0"</span>, <span class="st">"#F6DE90"</span>, <span class="st">"#E78200"</span>, <span class="st">"#A51122"</span><span class="op">)</span>
<span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">names</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="va">names</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">arrange</span><span class="op">(</span><span class="va">names</span><span class="op">)</span>


<span class="va">mid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">dat_tab</span><span class="op">$</span><span class="va">y</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>

<span class="va">b</span> <span class="op">&lt;-</span> <span class="fu">plotAllLayers</span><span class="op">(</span><span class="va">dat_tab</span>, <span class="va">mid</span>, <span class="va">cutpoints</span><span class="op">$</span><span class="va">cuts</span>, <span class="va">cutpoints</span><span class="op">$</span><span class="va">color</span><span class="op">)</span>

<span class="va">b</span><span class="op">/</span><span class="va">a</span><span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span><span class="op">(</span>guides <span class="op">=</span> <span class="st">'collect'</span>, heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="ggHoriPlot_files/figure-html/midpoint_4-1.png" width="700"></p>
</div>
<div id="additional-features" class="section level1">
<h1 class="hasAnchor">
<a href="#additional-features" class="anchor"></a>Additional features</h1>
<div id="interval-data" class="section level2">
<h2 class="hasAnchor">
<a href="#interval-data" class="anchor"></a>Interval data</h2>
<p>Some data might have starting and end points for x values. If that is the case, the line chart will have a step-like shape. <code>ggHoriPlot</code> can also plot this kind of data. We simply need to specify the end coordinates using the <code>xend</code> aesthetics inside <code><a href="../reference/geom_horizon.html">geom_horizon()</a></code>:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">a</span> <span class="op">&lt;-</span> <span class="va">dat_tab</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/geom_horizon.html">geom_horizon</a></span><span class="op">(</span>
    <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, 
    xend <span class="op">=</span> <span class="va">xend</span>, 
    y<span class="op">=</span><span class="va">y</span>,
    fill<span class="op">=</span><span class="va">..Cutpoints..</span><span class="op">)</span>, 
    horizonscale <span class="op">=</span> <span class="fl">6</span>,
    origin <span class="op">=</span> <span class="st">'midpoint'</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_few.html">theme_few</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/scale_fill_hcl.html">scale_fill_hcl</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">cutpoints</span>  <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>
  cuts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">78.48221</span>,  <span class="fl">172.74027</span>,  <span class="fl">266.99833</span>, <span class="op">-</span><span class="fl">110.03390</span>, <span class="op">-</span><span class="fl">204.29196</span>, <span class="op">-</span><span class="fl">298.55001</span><span class="op">)</span>,
  names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'ypos1'</span>, <span class="st">'ypos2'</span>, <span class="st">'ypos3'</span>, <span class="st">'yneg1'</span>, <span class="st">'yneg2'</span>, <span class="st">'yneg3'</span><span class="op">)</span>, 
  color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#D7E2D4"</span>, <span class="st">"#36ABA9"</span>, <span class="st">"#324DA0"</span>, <span class="st">"#F6DE90"</span>, <span class="st">"#E78200"</span>, <span class="st">"#A51122"</span><span class="op">)</span>
<span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">names</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="va">names</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">arrange</span><span class="op">(</span><span class="va">names</span><span class="op">)</span>

<span class="va">dt</span> <span class="op">&lt;-</span> <span class="va">dat_tab</span> <span class="op">%&gt;%</span> 
  <span class="fu">pivot_longer</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">xend</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span><span class="op">)</span>

<span class="va">b</span> <span class="op">&lt;-</span> <span class="fu">plotAllLayers</span><span class="op">(</span><span class="va">dt</span>, <span class="va">mid</span>, <span class="va">cutpoints</span><span class="op">$</span><span class="va">cuts</span>, <span class="va">cutpoints</span><span class="op">$</span><span class="va">color</span><span class="op">)</span>

<span class="va">b</span><span class="op">/</span><span class="va">a</span><span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span><span class="op">(</span>guides <span class="op">=</span> <span class="st">'collect'</span>, heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="ggHoriPlot_files/figure-html/midpoint_with_xend-1.png" width="700"></p>
<p>As a side note, xend values need to be different from the following x value, otherwise <code>ggHoriPlot</code> might not work properly. If this is not the case, try subtracting a small value to xend.</p>
</div>
<div id="faceting" class="section level2">
<h2 class="hasAnchor">
<a href="#faceting" class="anchor"></a>Faceting</h2>
<p><code>ggHoriPlot</code> can also be used to facet the data, which is specially useful if different time series need to be compared:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tab_tot</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/geom_horizon.html">geom_horizon</a></span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y<span class="op">=</span><span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">type</span>, ncol <span class="op">=</span> <span class="fl">1</span>, scales <span class="op">=</span> <span class="st">'free_y'</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_few.html">theme_few</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/scale_fill_hcl.html">scale_fill_hcl</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="ggHoriPlot_files/figure-html/faceting-1.png" width="672"></p>
<p>Note that the cutpoints are calculated per facet separately, so the color of each plot is relative to itself. This can be seen when specifying <code>fill = ..Cutpoints..</code>:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">tab_tot</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/geom_horizon.html">geom_horizon</a></span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y<span class="op">=</span><span class="va">y</span>, fill <span class="op">=</span> <span class="va">..Cutpoints..</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">type</span>, ncol <span class="op">=</span> <span class="fl">1</span>, scales <span class="op">=</span> <span class="st">'free_y'</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_few.html">theme_few</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/scale_fill_hcl.html">scale_fill_hcl</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="ggHoriPlot_files/figure-html/faceting_cutpoints-1.png" width="672"></p>
<p>Here we can sew how there are six different cutpoints per facet. If we wanted to have the same cutpoints for all the facets, we would need to calculate them and supply them in the <code>horizonscale</code> argument of <code><a href="../reference/geom_horizon.html">geom_horizon()</a></code>:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ori</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">tab_tot</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>
<span class="va">sca</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">tab_tot</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">tab_tot</span><span class="op">$</span><span class="va">y</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, length.out <span class="op">=</span> <span class="fl">7</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">4</span><span class="op">]</span>

<span class="va">tab_tot</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/geom_horizon.html">geom_horizon</a></span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y<span class="op">=</span><span class="va">y</span>, fill <span class="op">=</span> <span class="va">..Cutpoints..</span><span class="op">)</span>,
               origin <span class="op">=</span> <span class="va">ori</span>, horizonscale <span class="op">=</span> <span class="va">sca</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu">facet_wrap</span><span class="op">(</span><span class="op">~</span><span class="va">type</span>, ncol <span class="op">=</span> <span class="fl">1</span>, scales <span class="op">=</span> <span class="st">'free_y'</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_few.html">theme_few</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/scale_fill_hcl.html">scale_fill_hcl</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p><img src="ggHoriPlot_files/figure-html/faceting_calculating_cutpoints-1.png" width="672"></p>
</div>
<div id="handling-outliers" class="section level2">
<h2 class="hasAnchor">
<a href="#handling-outliers" class="anchor"></a>Handling outliers</h2>
<p>Outliers or very prominent peaks and valleys might greatly distort a horizon plot making it hard to interpret. For example:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">300</span>
<span class="va">y</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">0.1</span> <span class="op">*</span> <span class="va">x</span><span class="op">)</span> <span class="op">+</span> <span class="fl">50</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">dnorm</a></span><span class="op">(</span><span class="va">x</span>, <span class="fl">150</span>, <span class="fl">2</span><span class="op">)</span>
<span class="va">dat_tab_outlier</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>,
       xend <span class="op">=</span> <span class="va">x</span><span class="op">+</span><span class="fl">0.9999</span>,
       y <span class="op">=</span> <span class="va">y</span><span class="op">)</span>

<span class="va">a1</span> <span class="op">&lt;-</span> <span class="va">dat_tab_outlier</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/geom_horizon.html">geom_horizon</a></span><span class="op">(</span>
    <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, 
    y<span class="op">=</span><span class="va">y</span>,
    fill<span class="op">=</span><span class="va">..Cutpoints..</span><span class="op">)</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_few.html">theme_few</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/scale_fill_hcl.html">scale_fill_hcl</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">cutpoints_a1</span>  <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>
  cuts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6.7492332</span>,  <span class="fl">8.6865390</span>, <span class="fl">10.6238449</span>,  <span class="fl">2.8746215</span>,  <span class="fl">0.9373156</span>, <span class="op">-</span><span class="fl">0.9999902</span><span class="op">)</span>,
  names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'ypos1'</span>, <span class="st">'ypos2'</span>, <span class="st">'ypos3'</span>, <span class="st">'yneg1'</span>, <span class="st">'yneg2'</span>, <span class="st">'yneg3'</span><span class="op">)</span>, 
  color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#D7E2D4"</span>, <span class="st">"#36ABA9"</span>, <span class="st">"#324DA0"</span>, <span class="st">"#F6DE90"</span>, <span class="st">"#E78200"</span>, <span class="st">"#A51122"</span><span class="op">)</span>
<span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">names</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="va">names</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">arrange</span><span class="op">(</span><span class="va">names</span><span class="op">)</span>

<span class="va">b1</span> <span class="op">&lt;-</span> <span class="fu">plotAllLayers</span><span class="op">(</span><span class="va">dat_tab_outlier</span>, <span class="fl">4.811927</span>, <span class="va">cutpoints_a1</span><span class="op">$</span><span class="va">cuts</span>, <span class="va">cutpoints_a1</span><span class="op">$</span><span class="va">color</span><span class="op">)</span>

<span class="op">(</span><span class="va">b1</span><span class="op">/</span><span class="va">a1</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html">plot_annotation</a></span><span class="op">(</span><span class="st">"origin = 'midpoint', rm.outliers = F"</span><span class="op">)</span><span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span><span class="op">(</span>guides <span class="op">=</span> <span class="st">'collect'</span>, heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="ggHoriPlot_files/figure-html/midpoint_outlier_1-1.png" width="700"></p>
<p>We might want to use the median instead of the default midpoint to balance the effect of the outlier:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">a3</span> <span class="op">&lt;-</span> <span class="va">dat_tab_outlier</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/geom_horizon.html">geom_horizon</a></span><span class="op">(</span>
    <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, 
    <span class="co"># xend = xend, </span>
    y<span class="op">=</span><span class="va">y</span>,
    fill<span class="op">=</span><span class="va">..Cutpoints..</span><span class="op">)</span>, 
    horizonscale <span class="op">=</span> <span class="fl">6</span>,
    origin <span class="op">=</span> <span class="st">'median'</span>,
    rm.outliers <span class="op">=</span> <span class="cn">F</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_few.html">theme_few</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/scale_fill_hcl.html">scale_fill_hcl</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">cutpoints_a3</span>  <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>
  cuts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2.008043</span>,  <span class="fl">3.945348</span>,  <span class="fl">5.882654</span>, <span class="op">-</span><span class="fl">1.866569</span>, <span class="op">-</span><span class="fl">3.803875</span>, <span class="op">-</span><span class="fl">5.741181</span><span class="op">)</span>,
  names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'ypos1'</span>, <span class="st">'ypos2'</span>, <span class="st">'ypos3'</span>, <span class="st">'yneg1'</span>, <span class="st">'yneg2'</span>, <span class="st">'yneg3'</span><span class="op">)</span>, 
  color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#D7E2D4"</span>, <span class="st">"#36ABA9"</span>, <span class="st">"#324DA0"</span>, <span class="st">"#F6DE90"</span>, <span class="st">"#E78200"</span>, <span class="st">"#A51122"</span><span class="op">)</span>
<span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">names</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="va">names</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">arrange</span><span class="op">(</span><span class="va">names</span><span class="op">)</span>

<span class="va">b3</span> <span class="op">&lt;-</span> <span class="fu">plotAllLayers</span><span class="op">(</span><span class="va">dat_tab_outlier</span>, <span class="fl">0.07073676</span>, <span class="va">cutpoints_a3</span><span class="op">$</span><span class="va">cuts</span>, <span class="va">cutpoints_a3</span><span class="op">$</span><span class="va">color</span><span class="op">)</span>

<span class="op">(</span><span class="va">b3</span><span class="op">/</span><span class="va">a3</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html">plot_annotation</a></span><span class="op">(</span><span class="st">"origin = 'median', rm.outliers = F"</span><span class="op">)</span><span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span><span class="op">(</span>guides <span class="op">=</span> <span class="st">'collect'</span>, heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="ggHoriPlot_files/figure-html/midpoint_outlier_2-1.png" width="700"></p>
<p>However, the horizon scale still renders the horizon plot difficult to interpret. Instead, we can tell <code>ggHoriPlot</code> to remove the outliers by setting the <code>rm.outliers</code> argument of <code><a href="../reference/geom_horizon.html">geom_horizon()</a></code> to <code>FALSE</code>:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">a2</span> <span class="op">&lt;-</span> <span class="va">dat_tab_outlier</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/geom_horizon.html">geom_horizon</a></span><span class="op">(</span>
    <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, 
    y<span class="op">=</span><span class="va">y</span>,
    fill<span class="op">=</span><span class="va">..Cutpoints..</span><span class="op">)</span>, 
    horizonscale <span class="op">=</span> <span class="fl">6</span>,
    origin <span class="op">=</span> <span class="st">'median'</span>,
    rm.outliers <span class="op">=</span> <span class="cn">T</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_few.html">theme_few</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/scale_fill_hcl.html">scale_fill_hcl</a></span><span class="op">(</span><span class="op">)</span>


<span class="va">cutpoints_a2</span>  <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>
  cuts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0.5743823</span>,  <span class="fl">1.1151416</span>,  <span class="fl">1.6559008</span>, <span class="op">-</span><span class="fl">0.5071362</span>, <span class="op">-</span><span class="fl">1.0478955</span>, <span class="op">-</span><span class="fl">1.5886547</span><span class="op">)</span>,
  names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'ypos1'</span>, <span class="st">'ypos2'</span>, <span class="st">'ypos3'</span>, <span class="st">'yneg1'</span>, <span class="st">'yneg2'</span>, <span class="st">'yneg3'</span><span class="op">)</span>, 
  color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#D7E2D4"</span>, <span class="st">"#36ABA9"</span>, <span class="st">"#324DA0"</span>, <span class="st">"#F6DE90"</span>, <span class="st">"#E78200"</span>, <span class="st">"#A51122"</span><span class="op">)</span>
<span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">names</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="va">names</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">arrange</span><span class="op">(</span><span class="va">names</span><span class="op">)</span>



<span class="va">b2</span> <span class="op">&lt;-</span> <span class="fu">plotAllLayers</span><span class="op">(</span><span class="va">dat_tab_outlier</span>, <span class="fl">0.03362305</span>, <span class="va">cutpoints_a2</span><span class="op">$</span><span class="va">cuts</span>, <span class="va">cutpoints_a2</span><span class="op">$</span><span class="va">color</span><span class="op">)</span>


<span class="op">(</span><span class="va">b2</span><span class="op">/</span><span class="va">a2</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html">plot_annotation</a></span><span class="op">(</span><span class="st">"origin = 'median', rm.outliers = T"</span><span class="op">)</span><span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span><span class="op">(</span>guides <span class="op">=</span> <span class="st">'collect'</span>, heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="ggHoriPlot_files/figure-html/midpoint_outlier_2_bis-1.png" width="700"></p>
<p>This will remove values below the 0.25 quantile - 1.5 times the interquartile range and above the 0.75 quantile + 1.5 times the interquartile range.</p>
<p>Another option would be to use a custom horizon scale, such as the one below:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">a4</span> <span class="op">&lt;-</span> <span class="va">dat_tab_outlier</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/geom_horizon.html">geom_horizon</a></span><span class="op">(</span>
    <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, 
    <span class="co"># xend = xend, </span>
    y<span class="op">=</span><span class="va">y</span>,
    fill<span class="op">=</span><span class="va">..Cutpoints..</span><span class="op">)</span>, 
    horizonscale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">/</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">[</span><span class="op">-</span><span class="fl">4</span><span class="op">]</span>,
    origin <span class="op">=</span> <span class="fl">0</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_few.html">theme_few</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/scale_fill_hcl.html">scale_fill_hcl</a></span><span class="op">(</span><span class="op">)</span>


<span class="va">cutpoints_a4</span>  <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>
  cuts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span>,  <span class="fl">2</span><span class="op">/</span><span class="fl">3</span>,  <span class="fl">1</span>, <span class="op">-</span><span class="fl">1</span><span class="op">/</span><span class="fl">3</span>, <span class="op">-</span><span class="fl">2</span><span class="op">/</span><span class="fl">3</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span>,
  names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'ypos1'</span>, <span class="st">'ypos2'</span>, <span class="st">'ypos3'</span>, <span class="st">'yneg1'</span>, <span class="st">'yneg2'</span>, <span class="st">'yneg3'</span><span class="op">)</span>, 
  color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#D7E2D4"</span>, <span class="st">"#36ABA9"</span>, <span class="st">"#324DA0"</span>, <span class="st">"#F6DE90"</span>, <span class="st">"#E78200"</span>, <span class="st">"#A51122"</span><span class="op">)</span>
<span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">names</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="va">names</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">arrange</span><span class="op">(</span><span class="va">names</span><span class="op">)</span>

<span class="va">b4</span> <span class="op">&lt;-</span> <span class="fu">plotAllLayers</span><span class="op">(</span><span class="va">dat_tab_outlier</span>, <span class="fl">0</span>, <span class="va">cutpoints_a4</span><span class="op">$</span><span class="va">cuts</span>, <span class="va">cutpoints_a4</span><span class="op">$</span><span class="va">color</span><span class="op">)</span>



<span class="op">(</span><span class="va">b4</span><span class="op">/</span><span class="va">a4</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_annotation.html">plot_annotation</a></span><span class="op">(</span><span class="st">"origin = 0, rm.outliers = F, custom horizonscale"</span><span class="op">)</span><span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span><span class="op">(</span>guides <span class="op">=</span> <span class="st">'collect'</span>, heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="ggHoriPlot_files/figure-html/custom_horizonscale-1.png" width="700"></p>
</div>
<div id="handling-of-missing-data" class="section level2">
<h2 class="hasAnchor">
<a href="#handling-of-missing-data" class="anchor"></a>Handling of missing data</h2>
<p>Missing data is removed from the plot:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">300</span>
<span class="va">y</span> <span class="op">=</span> <span class="va">x</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/Trig.html">sin</a></span><span class="op">(</span><span class="fl">0.1</span> <span class="op">*</span> <span class="va">x</span><span class="op">)</span>
<span class="va">dat_tab_na</span> <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>,
       xend <span class="op">=</span> <span class="va">x</span><span class="op">+</span><span class="fl">0.9999</span>,
       y <span class="op">=</span> <span class="va">y</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>
    y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html">ifelse</a></span><span class="op">(</span><span class="fu">between</span><span class="op">(</span><span class="va">x</span>, <span class="fl">125</span>, <span class="fl">175</span><span class="op">)</span>, <span class="cn">NA</span>, <span class="va">y</span><span class="op">)</span>
  <span class="op">)</span>


<span class="va">a</span> <span class="op">&lt;-</span> <span class="va">dat_tab_na</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/geom_horizon.html">geom_horizon</a></span><span class="op">(</span>
    <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, 
    y<span class="op">=</span><span class="va">y</span>,
    fill<span class="op">=</span><span class="va">..Cutpoints..</span><span class="op">)</span>, 
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_few.html">theme_few</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/scale_fill_hcl.html">scale_fill_hcl</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">cutpoints</span>  <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>
  cuts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">78.48221</span>,  <span class="fl">172.74027</span>,  <span class="fl">266.99833</span>, <span class="op">-</span><span class="fl">110.03390</span>, <span class="op">-</span><span class="fl">204.29196</span>, <span class="op">-</span><span class="fl">298.55001</span><span class="op">)</span>,
  names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'ypos1'</span>, <span class="st">'ypos2'</span>, <span class="st">'ypos3'</span>, <span class="st">'yneg1'</span>, <span class="st">'yneg2'</span>, <span class="st">'yneg3'</span><span class="op">)</span>, 
  color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#D7E2D4"</span>, <span class="st">"#36ABA9"</span>, <span class="st">"#324DA0"</span>, <span class="st">"#F6DE90"</span>, <span class="st">"#E78200"</span>, <span class="st">"#A51122"</span><span class="op">)</span>
<span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">names</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="va">names</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">arrange</span><span class="op">(</span><span class="va">names</span><span class="op">)</span>


<span class="va">mid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">dat_tab_na</span><span class="op">$</span><span class="va">y</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>

<span class="va">b</span> <span class="op">&lt;-</span> <span class="fu">plotAllLayers</span><span class="op">(</span><span class="va">dat_tab_na</span>, <span class="va">mid</span>, <span class="va">cutpoints</span><span class="op">$</span><span class="va">cuts</span>, <span class="va">cutpoints</span><span class="op">$</span><span class="va">color</span><span class="op">)</span>


<span class="va">b</span><span class="op">/</span><span class="va">a</span><span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span><span class="op">(</span>guides <span class="op">=</span> <span class="st">'collect'</span>, heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="ggHoriPlot_files/figure-html/midpoint_NA-1.png" width="700"></p>
</div>
<div id="reversing-the-values-below-the-origin" class="section level2">
<h2 class="hasAnchor">
<a href="#reversing-the-values-below-the-origin" class="anchor"></a>Reversing the values below the origin</h2>
<p>Some horizon plots do not reverse the values that are below the origin. If that is the desired output, it can be achieved by setting <code>reverse=T</code> in <code><a href="../reference/geom_horizon.html">geom_horizon()</a></code>:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">a</span> <span class="op">&lt;-</span> <span class="va">dat_tab</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/geom_horizon.html">geom_horizon</a></span><span class="op">(</span>
    <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, 
    <span class="co"># xend = xend, </span>
    y<span class="op">=</span><span class="va">y</span>, 
    fill<span class="op">=</span><span class="va">..Cutpoints..</span><span class="op">)</span>, 
    horizonscale <span class="op">=</span> <span class="fl">6</span>,
    origin <span class="op">=</span> <span class="st">'midpoint'</span>,
    reverse <span class="op">=</span> <span class="cn">T</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_few.html">theme_few</a></span><span class="op">(</span><span class="op">)</span>  <span class="op">+</span>
  <span class="fu"><a href="../reference/scale_fill_hcl.html">scale_fill_hcl</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">cutpoints</span>  <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>
  cuts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">78.48221</span>,  <span class="fl">172.74027</span>,  <span class="fl">266.99833</span>, <span class="op">-</span><span class="fl">110.03390</span>, <span class="op">-</span><span class="fl">204.29196</span>, <span class="op">-</span><span class="fl">298.55001</span><span class="op">)</span>,
  names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'ypos1'</span>, <span class="st">'ypos2'</span>, <span class="st">'ypos3'</span>, <span class="st">'yneg1'</span>, <span class="st">'yneg2'</span>, <span class="st">'yneg3'</span><span class="op">)</span>, 
  color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#D7E2D4"</span>, <span class="st">"#36ABA9"</span>, <span class="st">"#324DA0"</span>, <span class="st">"#F6DE90"</span>, <span class="st">"#E78200"</span>, <span class="st">"#A51122"</span><span class="op">)</span>
<span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">names</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="va">names</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">arrange</span><span class="op">(</span><span class="va">names</span><span class="op">)</span>

<span class="va">mid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">dat_tab_na</span><span class="op">$</span><span class="va">y</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>

<span class="va">b</span> <span class="op">&lt;-</span> <span class="fu">plotAllLayers</span><span class="op">(</span><span class="va">dat_tab</span>, <span class="va">mid</span>, <span class="va">cutpoints</span><span class="op">$</span><span class="va">cuts</span>, <span class="va">cutpoints</span><span class="op">$</span><span class="va">color</span><span class="op">)</span>


<span class="va">b</span><span class="op">/</span><span class="va">a</span><span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span><span class="op">(</span>guides <span class="op">=</span> <span class="st">'collect'</span>, heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="ggHoriPlot_files/figure-html/reverse-1.png" width="700"></p>
</div>
<div id="mirroring-the-horizon-plot" class="section level2">
<h2 class="hasAnchor">
<a href="#mirroring-the-horizon-plot" class="anchor"></a>Mirroring the horizon plot</h2>
<p>If you cant to mirror the horizon plot, you can do so by setting <code>mirror</code> to <code>TRUE</code>:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">a</span> <span class="op">&lt;-</span> <span class="va">dat_tab</span> <span class="op">%&gt;%</span> 
  <span class="fu">ggplot</span><span class="op">(</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="../reference/geom_horizon.html">geom_horizon</a></span><span class="op">(</span>
    <span class="fu">aes</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, 
    y<span class="op">=</span><span class="va">y</span>, 
    fill<span class="op">=</span><span class="va">..Cutpoints..</span><span class="op">)</span>,
    mirror <span class="op">=</span> <span class="cn">T</span>
  <span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="https://rdrr.io/pkg/ggthemes/man/theme_few.html">theme_few</a></span><span class="op">(</span><span class="op">)</span>  <span class="op">+</span>
  <span class="fu"><a href="../reference/scale_fill_hcl.html">scale_fill_hcl</a></span><span class="op">(</span><span class="op">)</span>

<span class="va">cutpoints</span>  <span class="op">&lt;-</span> <span class="fu">tibble</span><span class="op">(</span>
  cuts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">78.48221</span>,  <span class="fl">172.74027</span>,  <span class="fl">266.99833</span>, <span class="op">-</span><span class="fl">110.03390</span>, <span class="op">-</span><span class="fl">204.29196</span>, <span class="op">-</span><span class="fl">298.55001</span><span class="op">)</span>,
  names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'ypos1'</span>, <span class="st">'ypos2'</span>, <span class="st">'ypos3'</span>, <span class="st">'yneg1'</span>, <span class="st">'yneg2'</span>, <span class="st">'yneg3'</span><span class="op">)</span>, 
  color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"#D7E2D4"</span>, <span class="st">"#36ABA9"</span>, <span class="st">"#324DA0"</span>, <span class="st">"#F6DE90"</span>, <span class="st">"#E78200"</span>, <span class="st">"#A51122"</span><span class="op">)</span>
<span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">mutate</span><span class="op">(</span>names <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">names</span>, <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="va">names</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span> 
  <span class="fu">arrange</span><span class="op">(</span><span class="va">names</span><span class="op">)</span>

<span class="va">mid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/range.html">range</a></span><span class="op">(</span><span class="va">dat_tab_na</span><span class="op">$</span><span class="va">y</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span>

<span class="va">b</span> <span class="op">&lt;-</span> <span class="fu">plotAllLayers</span><span class="op">(</span><span class="va">dat_tab</span>, <span class="va">mid</span>, <span class="va">cutpoints</span><span class="op">$</span><span class="va">cuts</span>, <span class="va">cutpoints</span><span class="op">$</span><span class="va">color</span><span class="op">)</span>


<span class="va">b</span><span class="op">/</span><span class="va">a</span><span class="op">+</span> <span class="fu"><a href="https://patchwork.data-imaginist.com/reference/plot_layout.html">plot_layout</a></span><span class="op">(</span>guides <span class="op">=</span> <span class="st">'collect'</span>, heights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p><img src="ggHoriPlot_files/figure-html/mirror-1.png" width="700"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Iker Rivas-González.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
